<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ â€“ Ø£ÙØ±ÙŠ Ø¬Ù„ÙˆØ¨Ø§Ù„</title>
<link rel="stylesheet" href="/new-styles.css">
</head>
<body>
<div class="login-wrapper">
    <div class="login-box">
        <div class="logo-text">ğŸŒ</div>
        <h2>Ø£ÙØ±ÙŠ Ø¬Ù„ÙˆØ¨Ø§Ù„</h2>

        <div id="alert" class="alert alert-danger hidden"></div>

        <form id="loginForm">
            <div class="form-group">
                <label for="username">Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ / Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" id="username" placeholder="Ù…Ø«Ø§Ù„: 1111" autocomplete="username" required>
            </div>
            <div class="form-group">
                <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="current-password" required>
            </div>
            <button type="submit" class="btn btn-primary btn-block" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
        </form>

        <p class="text-muted mt-2" style="text-align:center">Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</p>
    </div>
</div>

<script src="/new-app.js"></script>
<script>
    requireGuest();

    const form = document.getElementById('loginForm');
    const alertBox = document.getElementById('alert');
    const loginBtn = document.getElementById('loginBtn');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        alertBox.classList.add('hidden');
        loginBtn.disabled = true;
        loginBtn.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...';

        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        try {
            const data = await demoLogin(username, password);
            if (data.success) {
                Session.set(data.user);
                window.location.href = '/new-home.html';
            } else {
                alertBox.textContent = data.message || 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                alertBox.classList.remove('hidden');
            }
        } catch {
            alertBox.textContent = 'ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
            alertBox.classList.remove('hidden');
        }

        loginBtn.disabled = false;
        loginBtn.textContent = 'Ø¯Ø®ÙˆÙ„';
    });
</script>
</body>
</html>
